---
format_version: "6"
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: ios

app:
  envs:
  - SOURCE_DIR: $BITRISE_SOURCE_DIR

trigger_map:
- push_branch: "*"
  workflow: ci
- pull_request_target_branch: "*"
  workflow: ci

workflows:
  ci:
    steps:
    - script:
        title: install docker-toolbox + virtualbox
        inputs:
        - content: |-
            #!/bin/bash
            set -ex
            brew cask install virtualbox
            brew cask install docker-toolbox
    - script:
        title: install docker-toolbox + virtualbox
        inputs:
        - content: docker-machine create dev
    - script:
        title: run mount script
        inputs:
          - working_dir: $SOURCE_DIR
          - content: |-
                      #!/bin/bash
                      set -ex
                      eval $(docker-machine env dev)
                      ls -al .
                      sudo bash ./docker_machine_mount_nfs.sh

